<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Preheat Determination Chart</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #E8F0FA;
        }

        svg {
            background-color: white;
            display: block;
            margin: auto;
        }

        .highlight {
            stroke: red !important;
            stroke-width: 4 !important;
        }
    </style>
</head>
<body>
    <h2>Material Groups</h2>
    <label for="groupLabel">Group Label (A-L):</label>
    <select id="groupLabel" onchange="highlightLine()">
        <option value="A">A</option>
        <option value="B">B</option>
        <option value="C">C</option>
        <option value="D">D</option>
        <option value="E">E</option>
        <option value="F">F</option>
        <option value="G">G</option>
        <option value="H">H</option>
        <option value="I">I</option>
        <option value="J">J</option>
        <option value="K">K</option>
        <option value="L">L</option>
    </select>
    <svg id="chart1" width="800" height="600"></svg>
    <svg id="chart2" width="800" height="600"></svg>

    <script>
        const svg1 = d3.select("#chart1"),
            svg2 = d3.select("#chart2"),
            width1 = +svg1.attr("width"),
            height1 = +svg1.attr("height"),
            width2 = +svg2.attr("width"),
            height2 = +svg2.attr("height"),
            margin = { top: 40, right: 50, bottom: 50, left: 50 };

        let paths1 = [], horizontalLines1 = [], paths2 = [], horizontalLines2 = [];

        function highlightLine() {
            const groupLabel = document.getElementById("groupLabel").value;
            
            [paths1, horizontalLines1, paths2, horizontalLines2].forEach(collection => {
                collection.forEach(path => path.classed("highlight", false));
            });
            
            const groupIndex = "ABCDEFGHIJKL".indexOf(groupLabel);
            if (groupIndex !== -1) {
                [paths1, horizontalLines1, paths2, horizontalLines2].forEach(collection => {
                    collection[groupIndex]?.classed("highlight", true);
                });
            }
        }

        function createChart(svg, width, height, data, xDomain, yDomain) {
            const xScale = d3.scaleLinear().domain(xDomain).range([margin.left, width - margin.right]);
            const yScale = d3.scaleLinear().domain(yDomain).range([height - margin.bottom, margin.top]);

            svg.append("g").attr("transform", `translate(0,${height - margin.bottom})`).call(d3.axisBottom(xScale));
            svg.append("g").attr("transform", `translate(${margin.left},0)`).call(d3.axisLeft(yScale));

            let paths = [], horizontalLines = [];
            
            const lineGenerator = d3.line()
                .x(d => xScale(d.x))
                .y(d => yScale(d.y))
                .curve(d3.curveCatmullRom.alpha(0.1));

            data.forEach(group => {
                const points = d3.range(10).map(i => ({
                    x: group.start.x + (group.end.x - group.start.x) * (i / 9),
                    y: group.start.y + (group.end.y - group.start.y) * Math.sin((i / 9) * Math.PI / 2)
                }));

                const path = svg.append("path")
                    .datum(points)
                    .attr("d", lineGenerator)
                    .attr("stroke", "blue")
                    .attr("stroke-width", 2)
                    .attr("fill", "none");

                paths.push(path);

                const horizontalLine = svg.append("line")
                    .attr("x1", xScale(group.end.x))
                    .attr("y1", yScale(group.end.y))
                    .attr("x2", xScale(xDomain[1]))
                    .attr("y2", yScale(group.end.y))
                    .attr("stroke", "blue")
                    .attr("stroke-width", 2);

                horizontalLines.push(horizontalLine);
            });

            return { paths, horizontalLines };
        }

        ({ paths: paths1, horizontalLines: horizontalLines1 } = createChart(svg1, width1, height1, [
            { label: 'A', start: { x: 3, y: 12 }, end: { x: 43, y: 3 } },
            { label: 'B', start: { x: 4, y: 12 }, end: { x: 51, y: 3.5 } },
            { label: 'C', start: { x: 5, y: 12 }, end: { x: 60, y: 4 } }
        ], [0, 125], [2, 12]));

        ({ paths: paths2, horizontalLines: horizontalLines2 } = createChart(svg2, width2, height2, [
            { label: 'B', start: { x: 1, y: 25 }, end: { x: 1.3, y: 0 } },
            { label: 'C', start: { x: 1.2, y: 50 }, end: { x: 1.6, y: 0 } },
            { label: 'D', start: { x: 1.3, y: 55 }, end: { x: 2.2, y: 0 } }
        ], [0, 6], [0, 250]));

        highlightLine();
    </script>
</body>
</html>
